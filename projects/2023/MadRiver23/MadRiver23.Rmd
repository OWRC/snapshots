---
title: Rainfall-Runoff Modelling of the Mad River
subtitle: An event-based HEC-HMS model of the Upper Mad River watershed. Prepaired for the NVCA
author: Oak Ridges Moraine Groundwater Program
date: "`r gsub(' 0', ' ', format(Sys.time(), '%d %B, %Y'))`"
output:
  html_document:
    toc: true
    toc_float: true
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# library(dplyr)
# library(tidyr)
# library(lubridate)
# library(mgcv)
# library(ggplot2)
# library(leaflet)
# library(leaflet.extras)
library(knitr)

df <- read.csv("O:/MadRiver23/02-goHECHMS/HEC-HMS_subbasins.csv")
```


# Introduction

## Upper Mad River

The Nottawasaga Valley Conservation Authority (NVCA) and The Oak Ridges Moraine Groundwater Program (ORMGP) have partnered to explore the applicability of the ORMGP's [__historical climate data service__](/interpolants/modelling/waterbudget/data.html) in supporting event-based HEC-HMS models built in Southern Ontario to investigate the rainfall-runoff response to extreme summer rainfall events. As a proof of concept, the ~246km² Upper Mad River watershed was identified as a good first candidate.

![](img/basemap.png)
*Upper Mad River watershed*

<br>

## HEC-HMS

The HEC-HMS model code and its construction proceeded in a manor to accommodate future continuous simulation  as planed by the NVCA. As such, the NVCA requested a "Deficit and Constant" method suitable for long term continuous modelling be included with the delivered model. The HEC-HMS model offered by the [US Army Corps of Engineers Hydrologic Engineering Center](https://www.hec.usace.army.mil/software/hec-hms/) includes such functionality as do many other model codes ([PRMS](https://www.usgs.gov/software/precipitation-runoff-modeling-system-prms), [Raven](http://raven.uwaterloo.ca/), [MikeSHE](https://www.mikepoweredbydhi.com/products/mike-she), [HydroGeoSphere](https://www.aquanty.com/hydrogeosphere), etc.), yet it was ultimately chosen due to the code:

1. being free of cost;
1. having an integrated Graphical User Interface (GUI);
1. having both event and continuous/deficit and constant modelling capabilities;
1. including powerful capabilities such as the [2D shallow water flow module included in HEC-RAS](https://www.hec.usace.army.mil/confluence/rasdocs/r2dum/latest/introduction/hec-ras-2d-modeling-advantages-capabilities).
1. being widely used both professionally and academically, thus making HEC-HMS the right application to be adopted institutionally due to its transferability.


![](img/HEC-HMS_screenshot.png)
*Snapshot of the Mad River HEC-HMS project*

<br>

## Design criteria

The model construction phase proceeded with certain constraints such that the model can be readily simulate continuous processes. For instance, the model was built with:

1. smaller (~10km²) subbasins commensurate with sub-watershed boundaries managed by the NVCA that also coincide with the ORMGP climate data service distribution. (In total there are 27 HEC-HMS Subbasins.)
1. watershed built using HEC-HMS's "GIS" functionality based on a 10m DEM.
1. applied map-based hydrologic processes (i.e., SCS curve method) that is best suited for simulating future land use change.


It's important to note that in practice, models are developed to be either event-based (e.g., individual extreme rainfall events) vs. continuous (e.g., long-term/seasonal hydrology, climate change, etc.) but rarely both. The ORMGP have maintains a near-real-time daily data set complete since 1901 built for long term continuous modelling needed for groundwater resource management. However, we also maintain a 6-hourly near-real-time climate data set since 2002. Both of these products are complete and are [spatially distributed to thousands of ~10km² sub-watersheds covering our jurisdiction](/interpolants/modelling/waterbudget/data.html).



The following snapshot has been prepared to assist the NVCA with preparation of HEC-HMS Technical Memo (Task 1.4) describing the methods used to compile necessary data, build the model, calibrate/verify the model and conduct a sensitivity analysis.




# Data Collection

The target for the Data Collection (Task 1.1) piece was the for the implementation of the ORMGP climate data service. As each of the HEC-HMS subbasin mapped well to the ORMGP's sub-watershed delineation, rainfall data was nonetheless derived from the ~10km² [CaPA-RDPA](https://weather.gc.ca/grib/grib2_RDPA_ps10km_e.html) grid shown below.  Compared with meteorological stations, the CaPA-RDPA product offers a refined spatial distribution of precipitation amounts. Given that most extreme summer events are of the convective type, many of these storms are themselves small scale and are susceptible of being unobserved by the relatively coarse station network.


![](img/capagrid.png)
*HEC-HMS subasins vs CaPA-RDPA resolution vs Nearest Active hourly climate stations*

<br>

## Analyze meteorological Data

There exist 3 meteorological stations 

1. 6111792: COLLINGWOOD [*see data*](https://owrc.shinyapps.io/sHyMet/?sID=148613)
1. 6117700: BARRIE-ORO [*see data*](https://owrc.shinyapps.io/sHyMet/?sID=697655275)
1. 611E001: EGBERT CS [*see data*](https://owrc.shinyapps.io/sHyMet/?sID=360000028)


Annual precipitation in the region have seen mixed trends as of late. for instance Collingwood shows a increasing trend over the past 30 years, whereas there's a decreasing trend at Egbert CS and no trend at Barri-Oro.

![](img/6111792-annual-precip-trend.png)

![](img/6111792-annual-snowpack-trend.png)

![](img/6111792-annual-meantemp-trend.png)
*mean daily temperature: 8°C*

![](img/6111792-daily-extreme-precip.png)




Analyze meteorological data (precipitation, snow, temperature, radiation)



## Analyze existing streamflow Data

Instantaneous (5min) streamflow data have been acquired from 2011 for 02ED015: MAD RIVER BELOW AVENING ([*see daily data*](https://owrc.shinyapps.io/sHyStreamflow/?sID=149142))


![](img/02ED015-cumulative.png)

![](img/02ED015-baseflow-snapshot.png)

![](img/02ED015-monthly-baseflow.png)

![](img/02ED015 summer extremes (Jun-Sep).png)


Analyze existing streamflow data (characterize large events (hydrograph analysis), baseflow analysis, statistical analysis)


### Timescale

![](img/compare1.png)


## Analyze geospatial data

Analyze applicable digital geospatial data sets including but not limited to soils, topography, land use to define hydrologic response units and appropriate catchments for the hydrologic model.


### DEM

OMRF (2019b): 10m horizontal resolution.

![](img/dem-screencapture.png)

<br>


### Land Use

Combination of SOLRIS v.3.0 for land use type (OMNR, 2019a) and OGS (2010) to classify the Curve Number (CN) method "hydrologic soil group".


#### Curve Number

![](img/basin-cn.png)
*based on a geospatial overlay of SOLRIS and OGS*


#### Percent Impervious

![](img/basin-imp.png)
*based on SOLRIS*

#### Initial Abstraction

![](img/basin-cov.png)
*relative vegetaiton cover based on SOLRIS*

<br>

# HEC-HMS modelling


Upper Mad River Hydrologic Modeling Using HEC-HMS (Task 1.2)


## Climate zones and subbasins

Delineate climate zones and subbasins and will complete meteorological and streamflow data processing for the Upper Mad River watershed.


![](img/basin-compare.png)


## Model structure

```{r tbl.subbsn}
kable(df, caption = 'cell-border stripe')
```




## Parameterization

1. SCS curve number method for runoff generation
1. Snyder unit hydrographs as the transfer function (global)
1. Simple recession for baseflow (global)
1. Simple lag for reaches (global)


## Process soil characteristics

Using the "PERMEABILI" attribute of OGS (2010) soil characteristics needed to estimate infiltration loss parameters for the Upper Mad River Watershed were determined.

![](img/basin-k.png)
*relative infiltration rates based on OGS, 2010*


<br>
<br>
<hr>
# *where I'm at...*
<hr>
<br>


## Model calibration and verification

calibrate/verify the HEC-HMS hydrologic model using available streamflow gauge data (Task 1.3).  A range of events will be used to simulate the complete flow regime.

### Objective function

Minimize the peak-weighted root mean square error objective function (USACE, 1998)

$$
  Z = \sqrt{\frac{1}{n}\sum^n\left[ \left(q_s-q_o\right)^2\cdot\left(\frac{q_o-\overline{q_o}}{\overline{q_o}}\right)\right]}
$$


## Event modelling

the SCS Curve Number method for the 2, 5, 10, 25, 50, 100-year design storms and the Timmins storm as per NVCA guidelines 


### SCS Curve Number method

*todo*


### Timmins Storm

*todo*


<br>

# References


Ontario Geological Survey 2010. Surficial geology of southern Ontario; Ontario Geological Survey, Miscellaneous Release— Data 128 – Revised.

Ontario Ministry of Natural Resources and Forestry, 2019a. Southern Ontario Land Resource Information System (SOLRIS) Version 3.0: Data Specifications. Science and Research Branch, April 2019

Ontario Ministry of Natural Resources and Forestry, 2019b. Ontario Digital Elevation Model (Imagery-Derived).

US Army Corps of Engineers, USACE (1998). HEC-1 flood hydrograph package user's manual. Hydrologic Engineering Center, Davis, CA.
